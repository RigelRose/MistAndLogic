select * from <%=BUSINESS_GRAPH%>."o_celonis_PurchaseOrder"

select Attribute from <%=BUSINESS_GRAPH%>."c_o_celonis_PurchaseOrder"

select * from <%=BUSINESS_GRAPH%>."e_celonis_SendPurchaseOrder"

select Attribute  
FROM <%=BUSINESS_GRAPH%>."o_celonis_PurchaseOrder" AS "PurchaseOrder"
         LEFT JOIN <%=BUSINESS_GRAPH%>."c_o_celonis_PurchaseOrder" AS "PurchaseOrder_Changes"
                   ON "PurchaseOrder"."ID" = "PurchaseOrder_Changes"."ObjectID"


SELECT
    <%=BUSINESS_GRAPH%>."o_celonis_SalesOrder"."CreationTime" AS "HeaderCreationTime",
    <%=BUSINESS_GRAPH%>."o_celonis_SalesOrderItem"."CreationTime" AS "ItemCreationTime"
FROM
    <%=BUSINESS_GRAPH%>."o_celonis_SalesOrderItem",<%=BUSINESS_GRAPH%>."o_celonis_SalesOrder"

   SELECT
    so."CreationTime" AS "HeaderCreationTime",
    si."CreationTime" AS "ItemCreationTime"
FROM
    <%=BUSINESS_GRAPH%>."o_celonis_SalesOrderItem" AS si
    JOIN <%=BUSINESS_GRAPH%>."o_celonis_SalesOrder" AS so ON si."Header_ID" = so."ID"
ORDER BY
    so."CreationTime" DESC

    SELECT 
    so."ID" AS "HeaderID",
    so."CreationTime" AS "HeaderCreationTime",
    si."CreationTime" AS "ItemCreationTime"
FROM
    <%=BUSINESS_GRAPH%>."o_celonis_SalesOrderItem" AS si
    JOIN <%=BUSINESS_GRAPH%>."o_celonis_SalesOrder" AS so ON si."Header_ID" = so."ID"
WHERE
    so."CreationTime" > si."CreationTime"


SELECT
    COUNT(si."ID") AS "TotalMatchingItems"
FROM
    <%=BUSINESS_GRAPH%>."o_celonis_SalesOrderItem" AS si
    JOIN <%=BUSINESS_GRAPH%>."o_celonis_SalesOrder" AS so ON si."Header_ID" = so."ID"
WHERE
    so."CreationTime" > si."CreationTime"

select EINDT,* from EKES where EBELN = '8600000025'

SELECT * FROM EKES WHERE EBELN in ('8600000025')

UPDATE EKES 
SET EINDT = CAST(EINDT AS DATE) + 
WHERE VBELN in ('8600000025')




SELECT EBELN FROM EKPO WHERE MATNR IS NOT NULL AND WERKS IS NOT NULL AND LENGTH(EBELN) = '10' 
 EBELN HAVING COUNT(EBELP) = 1

1) you will get ebeln values. -->100
2) you will also get distinct matnr and werks values. 
3) update matnr and werks for the identified ebeln values. 100 

SELECT VBELN FROM VBAP WHERE MATNR IS  NULL AND WERKS IS  NULL AND LENGTH(VBELN) = '10' 
GROUP BY VBELN HAVING COUNT(POSNR) = 1

1) you will get vbeln values. -->100
2) you will also get distinct matnr and werks values. 
3) update matnr and werks for the identified ebeln values. 100 


select * from vbap where vbeln = '7000000003'

select count(*) from vbap where matnr = '579' and werks = 'IN02' 


select count(*) from ekpo where matnr is not null and werks is not null 

select count(*) from vbap where matnr is not null and werks is not null

select * from ekpo where matnr is null

select matnr, werks from ekpo where ebeln = '2500000000'

----------------------------------------

SELECT VBELN FROM VBAP WHERE MATNR ISNULL AND WERKS ISNULL AND LENGTH(VBELN) = '10' and POSNR = '10' AND VBELN > '9000000006'
GROUP BY VBELN HAVING COUNT(DISTINCT POSNR) = 1  ORDER BY VBELN 

SELECT EBELN FROM EKPO WHERE MATNR ISNULL AND WERKS ISNULL AND LENGTH(EBELN) = '10' and EBELP = '00010' AND EBELN > '4500001031'
GROUP BY EBELN HAVING COUNT(DISTINCT EBELP) = 1  ORDER BY EBELN

SELECT DISTINCT MATNR,WERKS FROM EKPO

select count(distinct EBELN ) from ekpo WHERE MATNR IS not NULL AND WERKS IS not NULL AND LENGTH(EBELN) = '10' AND EBELP = '00010'
 HAVING COUNT(distinct EBELP) = 1

UPDATE EKPO 
SET MATNR = 'MOBILE_V'
SET WERKS = 'JKFR'
WHERE EBELN in ('2300000000',
'2300000001',
'2300000002',
'2300000003',
'2300000004',
'2300000005',
'2300000006',
'2300000008',
'2300000009',
'2300000010',
'2300000011',
'2300000012',
'2300000013',
'2300000014',
'2300000016')

UPDATE VBAP 
SET MATNR = 'MOBILE_V'
--SET WERKS = 'JKFR'
WHERE VBELN in ('1AB0000001',
'1AB0000002',
'1SL0000002',
'3000000000',
'3000000006',
'3000000007',
'3000000008',
'3000000009',
'3000000010',
'3000000011',
'3000000012',
'3000000013',
'3000000014',
'3000000015',
'3000000016')

UPDATE EKPO 
--SET MATNR = 'CHOCLATE CUPCAKE'
SET WERKS = 'K901'
WHERE EBELN in ('2300000017',
'2300000018',
'2300000019',
'2300000020',
'2300000021',
'2300000022',
'2300000023',
'2300000024',
'2300000025',
'2300000026',
'2300000027',
'2300000028',
'2300000029',
'2500000000',
'2500000001')

UPDATE VBAP 
SET MATNR = 'CHOCLATE CUPCAKE'
--SET WERKS = 'K901'
WHERE VBELN in ('3000000017',
'3000000018',
'3000000019',
'7000000000',
'7000000001',
'7000000002',
'7000000006',
'7000000007',
'7000000008',
'7000000010',
'7000000011',
'7000000014',
'7000000015',
'7000000016',
'7000000017')

UPDATE EKPO 
SET MATNR = '156'
--SET WERKS = 'HAMB'
WHERE EBELN in ('2500000002',
'2500000003',
'2500000004',
'2500000005',
'2500000006',
'2500000007',
'2500000008',
'2500000009',
'2500000010',
'2500000011',
'2500000012',
'2500000013',
'2500000014',
'2500000015',
'2500000016')

UPDATE VBAP 
--SET MATNR = '156'
SET WERKS = 'HAMB'
WHERE VBELN in ('7000000020',
'7000000024',
'7000000025',
'7000000026',
'7000000029',
'7000000032',
'7000000033',
'7000000034',
'7000000035',
'7000000038',
'7000000039',
'7000000041',
'7000000042',
'7000000043',
'7000000044')

UPDATE EKPO 
--SET MATNR = '400000017'
SET WERKS = 'IN44'
WHERE EBELN in ('2500000017',
'2500000018',
'2500000019',
'2500000020',
'2500000021',
'2500000022',
'2500000023',
'2500000024',
'2500000025',
'2500000026',
'2600000000',
'2600000001',
'2600000002',
'2600000003',
'2600000004')

UPDATE VBAP 
SET MATNR = '400000017'
--SET WERKS = 'IN44'
WHERE VBELN in ('7000000047',
'7000000048',
'7000000049',
'7000000051',
'7000000052',
'7000000053',
'7000000057',
'7000000058',
'7000000059',
'7000000060',
'7000000061',
'7000000062',
'7000000065',
'7000000066',
'7000000067')

UPDATE EKPO 
SET MATNR = '98'
--SET WERKS = '4612'
WHERE EBELN in ('2600000005',
'2600000006',
'2600000007',
'2600000008',
'2600000010',
'2600000011',
'2600000012',
'2600000013',
'2600000014',
'2600000015',
'2600000016',
'2600000017',
'2700000000',
'3000000000',
'3000000001')


UPDATE VBAP 
--SET MATNR = '98'
SET WERKS = '4612'
WHERE VBELN in ('7000000068',
'7000000070',
'7000000071',
'7000000074',
'7000000075',
'7000000076',
'7000000077',
'7000000080',
'7000000084',
'7000000085',
'7000000086',
'7000000092',
'7000000093',
'7000000094',
'7000000095')

UPDATE EKPO 
--SET MATNR = '130003'
SET WERKS = 'IF04'
WHERE EBELN in ('4100000000',
'4500000000',
'4500000001',
'4500000002',
'4500000003',
'4500000004',
'4500000005',
'4500000006',
'4500000007',
'4500000008',
'4500000009',
'4500000010',
'4500000011',
'4500000012',
'4500000013')


UPDATE VBAP 
SET MATNR = '130003'
--SET WERKS = 'IF04'
WHERE VBELN in ('7000000098',
'7000000099',
'7000000100',
'7000000101',
'7000000102',
'7000000105',
'7000000106',
'7000000107',
'7000000108',
'7000000110',
'7000000111',
'7000000115',
'7000000116',
'7000000117',
'7000000120')


UPDATE EKPO 
SET MATNR = '8000KIT_H'
--SET WERKS = 'P002'
WHERE EBELN in ('4500000014',
'4500000015',
'4500000016',
'4500000017',
'4500000018',
'4500000019',
'4500000020',
'4500000021',
'4500000022',
'4500000023',
'4500000024',
'4500000025',
'4500000026',
'4500000027',
'4500000028')

UPDATE VBAP 
--SET MATNR = '8000KIT_H'
SET WERKS = 'P002'
WHERE VBELN in ('7000000123',
'7000000124',
'7000000125',
'7000000126',
'7000000129',
'7000000132',
'7000000133',
'7000000134',
'7000000135',
'7000000136',
'7000000137',
'7000000138',
'7000000139',
'7000000140',
'7000000141')

UPDATE EKPO 
--SET MATNR = 'VANILLACHIP_01'
SET WERKS = 'K901'
WHERE EBELN in ('4500000029',
'4500000030',
'4500000031',
'4500000032',
'4500000033',
'4500000034',
'4500000035',
'4500000036',
'4500000037',
'4500000038',
'4500000039',
'4500000040',
'4500000042',
'4500000043',
'4500000044')

UPDATE VBAP 
SET MATNR = 'VANILLACHIP_01'
--SET WERKS = 'K901'
WHERE VBELN in ('7000000142',
'7000000143',
'7000000145',
'7000000146',
'7000000147',
'7000000148',
'7000000149',
'7000000150',
'7000000151',
'7000000152',
'7000000153',
'7000000154',
'7000000155',
'7000000156',
'7000000157')

UPDATE EKPO 
--SET MATNR = '777'
SET WERKS = 'YZ1A'
WHERE EBELN in ('4500000045',
'4500000046',
'4500000047',
'4500000048',
'4500000049',
'4500000050',
'4500000051',
'4500000052',
'4500000053',
'4500000054',
'4500000055',
'4500000056',
'4500000057',
'4500000058',
'4500000059')

UPDATE VBAP 
SET MATNR = '777'
--SET WERKS = 'YZ1A'
WHERE VBELN in ('7000000158',
'7000000159',
'7000000160',
'7000000161',
'7000000162',
'7000000163',
'7000000164',
'7000000165',
'7000000166',
'7000000167',
'7000000168',
'7000000169',
'7000000170',
'7000000171',
'7000000172')

UPDATE EKPO 
SET MATNR = 'SAMSUNGS22'
--SET WERKS = 'JKFR'
WHERE EBELN in ('4500000060',
'4500000061',
'4500000062',
'4500000063',
'4500000064',
'4500000065',
'4500000066',
'4500000067',
'4500000068',
'4500000069',
'4500000070',
'4500000071',
'4500000072',
'4500000073',
'4500000074')

UPDATE VBAP 
--SET MATNR = 'SAMSUNGS22'
SET WERKS = 'JKFR'
WHERE VBELN in ('7000000173',
'7000000174',
'7000000175',
'7000000176',
'7000000177',
'7000000178',
'7000000179',
'7000000180',
'7000000181',
'7000000182',
'7000000183',
'7000000184',
'7000000185',
'7000000186',
'7000000187')

UPDATE EKPO 
--SET MATNR = '801500H'
SET WERKS = 'EYA1'
WHERE EBELN in ('4500000075',
'4500000076',
'4500000077',
'4500000078',
'4500000079',
'4500000080',
'4500000081',
'4500000082',
'4500000083',
'4500000084',
'4500000085',
'4500000086',
'4500000087',
'4500000088',
'4500000089')

UPDATE VBAP 
SET MATNR = '801500H'
--SET WERKS = 'EYA1'
WHERE VBELN in ('7000000188',
'7000000189',
'7000000190',
'7000000191',
'7000000192',
'7000000193',
'7000000194',
'7000000195',
'7000000196',
'7000000197',
'7000000198',
'7000000199',
'7000000200',
'7000000201',
'7000000202')

UPDATE EKPO 
SET MATNR = '579'
--SET WERKS = 'IN02'
WHERE EBELN in ('4500000090',
'4500000091',
'4500000092',
'4500000093',
'4500000094',
'4500000095',
'4500000096',
'4500000097',
'4500000098',
'4500000099',
'4500000100',
'4500000102',
'4500000103',
'4500000104',
'4500000105')

UPDATE VBAP 
--SET MATNR = '579'
SET WERKS = 'IN02'
WHERE VBELN in ('7000000203',
'7000000204',
'7000000205',
'7000000206',
'7000000207',
'7000000208',
'7000000209',
'7000000210',
'7000000211',
'7000000212',
'7000000213',
'7000000214',
'7000000215',
'7000000216',
'7000000217')

UPDATE EKPO 
--SET MATNR = 'FL0433'
SET WERKS = 'PU01'
WHERE EBELN in ('4500000106',
'4500000107',
'4500000108',
'4500000109',
'4500000110',
'4500000111',
'4500000112',
'4500000113',
'4500000114',
'4500000115',
'4500000116',
'4500000117',
'4500000118',
'4500000119',
'4500000120')

UPDATE VBAP 
SET MATNR = 'FL0433'
--SET WERKS = 'PU01'
WHERE VBELN in ('7000000218',
'7000000219',
'7000000220',
'7000000221',
'7000000222',
'7000000223',
'7000000224',
'7000000225',
'7000000226',
'7000000227',
'7000000228',
'7000000229',
'7000000230',
'7000000231',
'7000000232')

UPDATE EKPO 
SET MATNR = 'FINALPROD01'
--SET WERKS = '8100'
WHERE EBELN in ('4500000121',
'4500000122',
'4500000123',
'4500000124',
'4500000125',
'4500000126',
'4500000127',
'4500000128',
'4500000129',
'4500000130',
'4500000131',
'4500000132',
'4500000133',
'4500000134',
'4500000135')


UPDATE VBAP 
--SET MATNR = 'FINALPROD01'
SET WERKS = '8100'
WHERE VBELN in ('7000000233',
'7000000234',
'7000000235',
'7000000236',
'7000000237',
'7000000238',
'7000000239',
'7000000240',
'7000000241',
'7000000242',
'7000000243',
'7000000244',
'7000000245',
'7000000246',
'7000000247')

UPDATE EKPO 
--SET MATNR = 'PH500006'
SET WERKS = 'IF01'
WHERE EBELN in ('4500000136',
'4500000137',
'4500000138',
'4500000139',
'4500000140',
'4500000141')

UPDATE VBAP 
SET MATNR = 'PH500006'
--SET WERKS = 'IF01'
WHERE VBELN in ('9000000000',
'9000000001',
'9000000003',
'9000000004',
'9000000005',
'9000000006')
